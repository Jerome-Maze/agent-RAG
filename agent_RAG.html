
<script>
  const url = "https://sonicbzh.app.n8n.cloud/webhook/total-chat"; // PROD URL

  async function send() {
    const question = document.getElementById('q').value.trim();
    if (!question) return;

    // On utilise x-www-form-urlencoded pour éviter le preflight CORS
    const body = new URLSearchParams({ question });

    // Pas d'en-tête 'Content-Type: application/json' => pas de preflight
    const res = await fetch(url, {
      method: "POST",
      body
    });

    // Essaie de lire du texte d'abord (selon comment tu réponds côté n8n)
    let text;
    try {
      text = await res.text();
    } catch (e) {
      text = "Erreur en lisant la réponse";
    }
    document.getElementById('out').textContent = text || "(réponse vide)";
  }
</script>
``
